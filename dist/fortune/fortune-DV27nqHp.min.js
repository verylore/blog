const t="fortune_today",e=[{name:"물병자리",emoji:"♒",start:[1,20],end:[2,18]},{name:"물고기자리",emoji:"♓",start:[2,19],end:[3,20]},{name:"양자리",emoji:"♈",start:[3,21],end:[4,19]},{name:"황소자리",emoji:"♉",start:[4,20],end:[5,20]},{name:"쌍둥이자리",emoji:"♊",start:[5,21],end:[6,21]},{name:"게자리",emoji:"♋",start:[6,22],end:[7,22]},{name:"사자자리",emoji:"♌",start:[7,23],end:[8,22]},{name:"처녀자리",emoji:"♍",start:[8,23],end:[9,22]},{name:"천칭자리",emoji:"♎",start:[9,23],end:[10,22]},{name:"전갈자리",emoji:"♏",start:[10,23],end:[11,22]},{name:"사수자리",emoji:"♐",start:[11,23],end:[12,21]},{name:"염소자리",emoji:"♑",start:[12,22],end:[1,19]}],n=[{name:"쥐띠",emoji:"🐭",offset:0},{name:"소띠",emoji:"🐮",offset:1},{name:"호랑이띠",emoji:"🐯",offset:2},{name:"토끼띠",emoji:"🐰",offset:3},{name:"용띠",emoji:"🐲",offset:4},{name:"뱀띠",emoji:"🐍",offset:5},{name:"말띠",emoji:"🐴",offset:6},{name:"양띠",emoji:"🐑",offset:7},{name:"원숭이띠",emoji:"🐵",offset:8},{name:"닭띠",emoji:"🐔",offset:9},{name:"개띠",emoji:"🐶",offset:10},{name:"돼지띠",emoji:"🐷",offset:11}];let o={overall:["오늘은 전반적으로 균형잡힌 하루가 될 것입니다.","새로운 기회와 도전이 찾아올 수 있는 날입니다.","긍정적인 에너지가 흐르는 특별한 하루예요.","안정적이면서도 활력이 넘치는 시간을 보낼 수 있습니다."],love:["새로운 만남이 당신을 기다리고 있습니다.","연인과의 관계가 한층 더 깊어질 것입니다.","과거의 인연이 다시 찾아올 수 있습니다.","진실한 사랑을 발견하게 될 날입니다."],money:["예상치 못한 수입이 생길 수 있습니다.","투자에 대한 좋은 소식이 있을 것입니다.","절약하는 습관이 큰 도움이 될 것입니다.","금전 관리에 신중함이 필요한 시기입니다."],work:["업무에서 좋은 성과를 거둘 수 있는 날입니다.","새로운 기회가 당신 앞에 펼쳐질 것입니다.","동료들과의 협력이 큰 힘이 될 것입니다.","창의적인 아이디어가 떠오르는 하루입니다."],study:["학습 능력이 향상되는 시기입니다.","새로운 지식을 흡수하기 좋은 날이에요.","집중력이 높아져 효율적인 공부가 가능합니다.","성적 향상의 기회가 찾아올 수 있어요."],health:["활력이 넘치는 하루가 될 것입니다.","규칙적인 운동이 큰 도움이 될 것입니다.","충분한 휴식을 취하는 것이 중요합니다.","건강한 식습관을 유지하세요."],tips:["긍정적인 마음가짐이 행운을 불러올 것입니다.","주변 사람들에게 감사한 마음을 표현해보세요.","새로운 도전을 두려워하지 마세요.","직감을 믿고 행동하는 것이 좋겠습니다."],moods:["활발함","차분함","열정적","신중함","유쾌함","집중력","창의적","안정감"],adjectives:["빛나는","행복한","평화로운","역동적인","따뜻한","멋진","특별한","화려한"]};const a={dawn:{name:"새벽",boost:"health",desc:"새로운 시작"},morning:{name:"오전",boost:"work",desc:"활동적 에너지"},noon:{name:"정오",boost:"money",desc:"풍요로운 기운"},afternoon:{name:"오후",boost:"love",desc:"따뜻한 감정"},evening:{name:"저녁",boost:"study",desc:"학습과 성찰"},night:{name:"밤",boost:"overall",desc:"내면의 지혜"}},c={male:{overall:1,love:1,money:1.05,work:1.1,study:1.05,health:1},female:{overall:1,love:1.1,money:1,work:1,study:1,health:1.05}},r={solar:{multiplier:1,desc:"서구식 에너지"},lunar:{multiplier:1.05,desc:"전통 운세력"},"lunar-leap":{multiplier:1.1,desc:"특별한 운명력"}};function i(t){const e=1e4*Math.sin(t);return e-Math.floor(e)}function s(t,e){return t[Math.floor(i(e)*t.length)]}function m(){try{return JSON.parse(localStorage.getItem(t)||"null")}catch(e){return null}}const d=document.getElementById("header-title");document.getElementById("input-section");const u=document.getElementById("result-card");document.querySelectorAll('input[name="gender"]'),document.querySelectorAll('input[name="calendar"]');const l=document.getElementById("birth-year"),f=document.getElementById("birth-month"),h=document.getElementById("birth-day"),w=document.getElementById("birth-hour"),v=document.getElementById("birth-minute"),y=document.getElementById("check-fortune-btn"),j=document.getElementById("res-ico"),b=document.getElementById("res-title"),$=document.getElementById("res-info"),p=document.getElementById("res-date"),M=document.getElementById("res-meter"),g=document.getElementById("res-overall"),k=document.getElementById("res-love"),D=document.getElementById("res-money"),I=document.getElementById("res-work"),T=document.getElementById("res-study"),S=document.getElementById("res-health"),z=document.getElementById("zodiac-emoji"),O=document.getElementById("zodiac-name"),x=document.getElementById("chinese-zodiac-emoji"),H=document.getElementById("chinese-zodiac-name"),J=document.querySelectorAll(".tab-btn"),K=document.querySelectorAll(".tab-pane");J.forEach(t=>{t.addEventListener("click",t=>{!function(t){J.forEach(t=>t.classList.remove("active")),K.forEach(t=>t.classList.remove("active"));const e=document.querySelector(`.tab-btn[data-tab="${t}"]`),n=document.getElementById(`tab-${t}`);e&&n&&(e.classList.add("active"),n.classList.add("active"))}(t.currentTarget.getAttribute("data-tab"))})});const N=document.getElementById("btn-share"),R=document.getElementById("year");function B(){const t=parseInt(l.value),e=parseInt(f.value);if(!t||!e)return;const n=new Date(t,e,0).getDate(),o=parseInt(h.value);for(;h.children.length>1;)h.removeChild(h.lastChild);for(let a=1;a<=n;a++){const t=document.createElement("option");t.value=a,t.textContent=`${a}일`,h.appendChild(t)}o&&o<=n&&(h.value=o)}async function C(){const e={gender:(null==(n=document.querySelector('input[name="gender"]:checked'))?void 0:n.value)||"male",calendar:(null==(d=document.querySelector('input[name="calendar"]:checked'))?void 0:d.value)||"solar",birthYear:l.value,birthMonth:f.value,birthDay:h.value,birthHour:w.value,birthMinute:v.value};var n,d;if(!function(t){return t.birthYear&&t.birthMonth&&t.birthDay}(e))return void alert("생년월일을 모두 입력해주세요.");const u=(new Date).toISOString().split("T")[0],j=m();if(j&&j.date===u&&j.userInfo.gender===e.gender&&j.userInfo.calendar===e.calendar&&j.userInfo.birthYear===e.birthYear&&j.userInfo.birthMonth===e.birthMonth&&j.userInfo.birthDay===e.birthDay&&j.userInfo.birthHour===e.birthHour&&j.userInfo.birthMinute===e.birthMinute)E(j);else{y.disabled=!0,y.textContent="🔮 운세 확인 중...";try{await async function(){try{const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"./":"https://cdn.jsdelivr.net/gh/verylore/blog/dist/fortune/";let n="fortune-data.json";try{const t=await fetch(e+"build-timestamp.txt");if(t.ok){const o=`build-${(await t.text()).trim()}.json`,a=await fetch(e+o);if(a.ok){const t=(await a.json()).manifest,o=await fetch(e+t);o.ok&&(n=(await o.json())["fortune-data.json"]||n)}}}catch(t){}const a=await fetch(e+n);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const c=await a.json();return c.fortunes&&(o.overall=c.fortunes.overall||o.overall,o.love=c.fortunes.love||o.love,o.money=c.fortunes.money||o.money,o.work=c.fortunes.work||o.work,o.study=c.fortunes.study||o.study,o.health=c.fortunes.health||o.health,o.tips=c.fortunes.general||o.tips),c.moods&&(o.moods=c.moods),c.adjectives&&(o.adjectives=c.adjectives),!0}catch(e){return!1}}();const n=function(t){const e=(new Date).toISOString().split("T")[0],n=function(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return Math.abs(e)}(`${t.gender}-${t.calendar}-${t.birthYear}-${t.birthMonth}-${t.birthDay}-${t.birthHour||"unknown"}-${e}`),m=(d=n,Math.floor(66*i(d))+30);var d;const u=c[t.gender]||c.male,l=r[t.calendar]||r.solar;let f=null;if(""!==t.birthHour){const e=(h=parseInt(t.birthHour))>=5&&h<9?"dawn":h>=9&&h<12?"morning":h>=12&&h<14?"noon":h>=14&&h<18?"afternoon":h>=18&&h<22?"evening":"night";f=a[e]}var h;const w=parseInt(t.birthYear)%10%4,v={overall:Math.min(95,Math.round(m*u.overall*l.multiplier+w)),love:Math.min(95,Math.round(m*u.love*l.multiplier+w)),money:Math.min(95,Math.round(m*u.money*l.multiplier+w)),work:Math.min(95,Math.round(m*u.work*l.multiplier+w)),study:Math.min(95,Math.round(m*u.study*l.multiplier+w)),health:Math.min(95,Math.round(m*u.health*l.multiplier+w))};return f&&v[f.boost]&&(v[f.boost]=Math.min(95,v[f.boost]+5)),{userInfo:t,totalScore:Math.round((v.overall+v.love+v.money+v.work+v.study+v.health)/6),scores:v,fortunes:{overall:s(o.overall,n+1),love:s(o.love,n+2),money:s(o.money,n+3),work:s(o.work,n+4),study:s(o.study,n+5),health:s(o.health,n+6),tip:s(o.tips,n+7)},mood:s(o.moods,n+10),adjective:s(o.adjectives,n+11),timeBoost:f,calendarInfo:l,date:e}}(e);E(n),function(e){try{localStorage.setItem(t,JSON.stringify(e))}catch(n){}}(n)}catch(b){alert("운세 생성 중 오류가 발생했습니다. 다시 시도해주세요.")}finally{y.disabled=!1,y.textContent="🔮 내 운세 확인하기"}}}function E(t){u.hidden=!1,u.style.animation="none",setTimeout(()=>{u.style.animation="slideInUp 0.6s ease-out"},10),j.textContent="🔮";const o="male"===t.userInfo.gender?"남성":"여성",a={solar:"양력",lunar:"음력(평달)","lunar-leap":"음력(윤달)"}[t.userInfo.calendar]||"양력";b.textContent=`${o} • ${t.userInfo.birthYear}년 ${t.userInfo.birthMonth}월 ${t.userInfo.birthDay}일`,$.textContent=`${a} • ${t.calendarInfo.desc}`,p.textContent=(new Date).toLocaleDateString("ko-KR");const c=Math.round(t.totalScore/100*360);M.style.setProperty("--deg",`${c}deg`),M.setAttribute("data-val",t.totalScore),g.textContent=t.fortunes.overall,k.textContent=t.fortunes.love,D.textContent=t.fortunes.money,I.textContent=t.fortunes.work,T.textContent=t.fortunes.study,S.textContent=t.fortunes.health;const r=function(t,n){for(const o of e){const[e,a]=o.start,[c,r]=o.end;if("염소자리"===o.name){if(12===t&&n>=a||1===t&&n<=r)return o}else{if(t===e&&n>=a)return o;if(t===c&&n<=r)return o}}return e[0]}(t.userInfo.birthMonth,t.userInfo.birthDay),i=(s=t.userInfo.birthYear,n[(s-1900)%12]);var s;z.textContent=r.emoji,O.textContent=r.name,x.textContent=i.emoji,H.textContent=i.name,t.timeBoost&&($.textContent+=` • ${t.timeBoost.name} ${t.timeBoost.desc}`),u.scrollIntoView({behavior:"smooth"})}async function L(){const t={title:"오늘의 운세",text:`${b.textContent}의 오늘 운세를 확인해보세요!`,url:window.location.href};try{navigator.share?await navigator.share(t):(await navigator.clipboard.writeText(window.location.href),alert("링크가 클립보드에 복사되었습니다!"))}catch(e){}}document.addEventListener("DOMContentLoaded",function(){R.textContent=(new Date).getFullYear(),function(){const t=(new Date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"});d.textContent=`${t} 오늘의 운세`}(),function(){for(let t=(new Date).getFullYear()-15;t>=1950;t--){const e=document.createElement("option");e.value=t,e.textContent=`${t}년`,l.appendChild(e)}for(let t=1;t<=12;t++){const e=document.createElement("option");e.value=t,e.textContent=`${t}월`,f.appendChild(e)}for(let t=1;t<=31;t++){const e=document.createElement("option");e.value=t,e.textContent=`${t}일`,h.appendChild(e)}for(let t=0;t<24;t++){const e=document.createElement("option");e.value=t,e.textContent=`${t.toString().padStart(2,"0")}시`,w.appendChild(e)}for(let t=0;t<60;t+=5){const e=document.createElement("option");e.value=t,e.textContent=`${t.toString().padStart(2,"0")}분`,v.appendChild(e)}}(),y.addEventListener("click",C),N.addEventListener("click",L),f.addEventListener("change",B),l.addEventListener("change",B);const t=m();t&&t.date===(new Date).toISOString().split("T")[0]&&E(t)});
